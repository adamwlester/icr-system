%%
% [StepRun] Speed Ratios Average: Rear=0.956565 Front=1.000382
vel = [ ...
5.00, ...
10.00, ...
15.00, ...
20.00, ...
25.00, ...
30.00, ...
35.00, ...
40.00, ...
45.00, ...
50.00, ...
55.00, ...
60.00, ...
65.00, ...
70.00, ...
75.00, ...
80.00, ...
85.00, ...
90.00, ...
];

r_vel = [ ...
5.237604, ...
10.479738, ...
15.719607, ...
20.964657, ...
26.204202, ...
31.450872, ...
36.704025, ...
41.950050, ...
47.176308, ...
52.424599, ...
57.702722, ...
62.971790, ...
68.185693, ...
73.439828, ...
78.758590, ...
83.983170, ...
89.193482, ...
94.352616, ...
];

f_vel = [ ...
5.110435, ...
10.214716, ...
15.305486, ...
20.385244, ...
25.464726, ...
30.544833, ...
35.624948, ...
40.702016, ...
45.800757, ...
50.883624, ...
55.951848, ...
61.023742, ...
66.113018, ...
71.219985, ...
76.348336, ...
81.482230, ...
86.554083, ...
91.601514, ...
];

r_ratio = [ ...
0.954635, ...
0.954222, ...
0.954222, ...
0.953987, ...
0.954045, ...
0.953869, ...
0.953574, ...
0.953515, ...
0.953869, ...
0.953751, ...
0.953161, ...
0.952808, ...
0.953279, ...
0.953161, ...
0.952277, ...
0.952572, ...
0.952984, ...
0.953869, ...
];

f_ratio = [ ...
0.978390, ...
0.978980, ...
0.980041, ...
0.981102, ...
0.981750, ...
0.982163, ...
0.982458, ...
0.982752, ...
0.982517, ...
0.982634, ...
0.982988, ...
0.983224, ...
0.983165, ...
0.982870, ...
0.982340, ...
0.981809, ...
0.982045, ...
0.982517, ...
];

% Plot ratios
figure;
plot(vel', [r_ratio',f_ratio'], '*--')
legend('Rear','Front');

% Do ls fit
b_r = regress(vel',[ones(length(vel),1) r_vel']);
b_f = regress(vel',[ones(length(vel),1) f_vel']);
% print
fprintf('{%0.15f, %0.15f}\r', b_r(2), b_r(1));
fprintf('{%0.15f, %0.15f}\r', b_f(2), b_f(1));

% % Do polyfit 3rd
% % rear
% p_r = polyfit(r_vel, vel, 3);
% p_r_s = p_r(1).*r_vel.^3 + p_r(2).*r_vel.^2 + p_r(3).*r_vel.^1 + p_r(4);
% % front
% p_f = polyfit(f_vel, vel, 3);
% p_f_s = p_f(1).*f_vel.^3 + p_f(2).*f_vel.^2 + p_f(3).*f_vel.^1 + p_f(4);
% % print
% fprintf('%0.15f,\r', p_r);
% fprintf('%0.15f,\r', p_f);

% Do polyfit 4th
% rear
p_r = polyfit(r_vel, vel, 4);
p_r_s = p_r(1).*r_vel.^4 + p_r(2).*r_vel.^3 + p_r(3).*r_vel.^2 + p_r(4).*r_vel.^1 + p_r(5);
% front
p_f = polyfit(f_vel, vel, 4);
p_f_s = p_f(1).*f_vel.^4 + p_f(2).*f_vel.^3 + p_f(3).*f_vel.^2 + p_f(4).*f_vel.^1 + p_f(5);
% print
fprintf('poly rear\r');
fprintf('%0.15f,\r', p_r);
fprintf('poly front\r');
fprintf('%0.15f,\r', p_f);

% p_rlot raw velocities
figure;
plot(vel', vel', 'k');
hold on
plot(vel', [r_vel',f_vel'], '*-')
% Plot polly fit corrected vels
plot(vel', [p_r_s', p_f_s'], '-.');
legend('Vel', 'Rear Raw','Front Raw','Rear Poly','Front Poly');
axis square
grid on

% Plot polly diff
figure
plot(vel', [diff([p_f_s', p_r_s'],1,2),diff([p_r_s', p_f_s'],1,2)], '*-')
legend('Polly Rear-Front','Polly Front-Rear');

%vel_raw = [r_vel', f_vel'];
%vel_lin = [r_vel', f_vel'];
%vel_scale = [r_vel', f_vel'];
% figure
% plot(vel', [vel_raw,vel_lin,vel_scale], '*-')
% legend('Rear_Raw','Front_Raw','Rear_Lin','Front_Lin','Rear_Scale','Front_Scale')
% axis square
% 
% figure
% plot(vel', [diff(vel_lin,1,2),diff(vel_scale,1,2)], '*-')
% legend('Diff_Lin','Diff_Scale')

