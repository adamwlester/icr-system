% PX = [192, 182, 171, 162, 154, ...
%     144, 137, 129, 121, 114, ...
%     107, 101, 94, 88, 82, ...
%     79, 73, 69, 65, 60, ...
%     57, 53, 49, 46, 43];
% PX = [189, 178, 170, 159, 150, ...
%     142, 134, 126, 119, 112, ...
%     105, 99, 92, 86, 80, ...
%     75, 71, 66, 60, 56, ...
%     51, 49, 46, 42, 38];
% PX = [126, 120, 114, 109, 104, ...
%     98, 93, 89, 85, 81, ...
%     77, 73, 69, 65, 62, ...
%     59, 56, 53, 50, 47, ...
%     44, 42, 39, 37, 34, ...
%     32, 30, 28, 26];
% PX = [...
%     191, 184, 176, 167, 157, ...
%     148, 140, 132, 124, 117, ...
%     110, 104, 97, 91, 85, ...
%     79, 74, 68, 64, 59.5, ...
%     55, 51, 47, 43, 39, ...
%     36, 32, 29.25, 26.15, 23, ...
%     20, 17, 15, 13.25, 11, ...
%     8.15, 6.15, 4, 3, 2, ...
%     ];  

CM = linspace(26, 69, 40);

PX = [...
    186, 178, 169, 161, 153, ...
    145, 138, 130, 123, 117, ...
    111, 105, 99, 94, 89 ...
    84, 79, 74, 70, 66 ...
    62, 58, 54, 51, 48 ...
    44, 40, 38, 35, 33, ...
    30, 27, 24.5, 22, 20, ...
    18, 16, 14.5, 13, 10.5 ...
    ];  

% Sample from 0 to 28 cm mark on cm template
P = polyfit(PX, CM, 4);

plot(CM, PX, '.-k');
axis square
hold on;

CM1 = P(1).*PX.^4 + P(2).*PX.^3 + P(3).*PX.^2 + P(4).*PX.^1 + P(5);
%PX1 = CM*p(1)^2 + CM*p(2) + p(3); 
plot(CM1, PX, '.-b');

% Copy these coeff values to arduino code
fprintf('%0.15f\n\r', P);